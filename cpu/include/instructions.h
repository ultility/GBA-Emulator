#pragma once

enum arm_instruction_set
{
    BRANCH,
    BRANCH_AND_EXCHANGE,
    SOFTWARE_INTERRUPT,
    UNDEFINED,
    DATA_PROCESSING,
    MULTIPLY,
    PSR_TRANSFER,
    SINGLE_DATA_TRANSFER,
    HDS_DATA_TRANSFER, // halfword, doubleword and signed data transfer
    BLOCK_DATA_TRANSFER,
    SINGLE_DATA_SWAP,
};

enum arm_instruction_set_opcodes
{
    BRANCH_OPCODE = 0b101 << 25,
    BRANCH_AND_EXCHANGE_OPCODE = 0b00010010111111111111 << 8,
    SOFTWARE_INTERRUPT_OPCODE = 0b1111 << 24,
    UNDEFINED_OPCODE = 0b011 << 25 | 0b1 << 4,
    DATA_PROCESSING_OPCODE = 0b00 << 26,
    MULTIPLY_OPCODE = 0b000 << 25,
    PSR_TRANSFER_OPCODE = 0b00 << 26 | 0b10 << 23 || 0b0 << 20,
    SINGLE_DATA_TRANSFER_OPCODE = 0b01 << 26,
    HDS_DATA_TRANSFER_OPCODE = 0b000 << 25 | 0b1 << 22,
    BLOCK_DATA_TRANSFER_OPCODE = 0b100 << 25,
    SINGLE_DATA_SWAP_OPCODE = 0b00010 << 23,
};

enum arm_instruction_set_opcode_masks
{
    BRANCH_OPCODE_MASK = 0b111 << 25,
    BRANCH_AND_EXCHANGE_OPCODE_MASK = 0b11111111111111111111 << 8,
    SOFTWARE_INTERRUPT_OPCODE_MASK = 0b1111 << 24,
    UNDEFINED_OPCODE_MASK = 0b111 << 25 | 0b1 << 4,
    DATA_PROCESSING_OPCODE_MASK = 0b11 << 26,
    MULTIPLY_OPCODE_MASK = 0b111 << 25,
    PSR_TRANSFER_OPCODE_MASK = 0b11 << 26 | 0b11 << 23 | 0b1 << 20,
    SINGLE_DATA_TRANSFER_OPCODE_MASK = 0b11 << 26,
    HDS_DATA_TRANSFER_OPCODE_MASK = 0b111 << 25 | 0b1 << 22,
    BLOCK_DATA_TRANSFER_OPCODE_MASK = 0b111 << 25,
    SINGLE_DATA_SWAP_OPCODE_MASK = 0b11111 << 23,
};

enum thumb_instruction_set
{
    THUMB_SOFTWARE_INTERRUPT,
    THUMB_UNCONDITIONAL_BRANCH,
    THUMB_CONDITIONAL_BRANCH,
    THUMB_MULTIPLE_LOAD_STORE,
    THUMB_LONG_BRANCH_AND_LINK,
    THUMB_OFFSET_STACKPOINTER,
    THUMB_PUSH_POP_REGISTERS,
    THUMB_LOAD_STORE_HALFWORD,
    THUMB_SP_RELATIVE_LOAD_STORE,
    THUMB_LOAD_ADDRESS,
    THUMB_LOAD_STORE_WITH_OFFSET,
    THUMB_LOAD_STORE_WITH_REG_OFFSET,
    THUMB_LOAD_STORE_SIGN_EXTENDED_BYTE_HALFWORD,
    THUMB_PC_RELATIVE_LOAD,
    THUMB_HI_REG_OPERATION_BRANCH_EXCHANGE,
    THUMB_ALU_OPERATIONS,
    THUMB_MOV_CMP_ADD_SUB_IMM,
    THUMB_ADD_SUB,
    THUMB_MOVE_SHIFTED_REGISTER,
};

enum thumb_instruction_set_opcode
{
    THUMB_SOFTWARE_INTERRUPT_OPCODE = 0b11011111 << 8,
    THUMB_UNCONDITIONAL_BRANCH_OPCODE = 0b11100 << 11,
    THUMB_CONDITIONAL_BRANCH_OPCODE = 0b1101 << 12,
    THUMB_MULTIPLE_LOAD_STORE_OPCODE = 0b1100 << 12,
    THUMB_LONG_BRANCH_AND_LINK_OPCODE = 0b1111 << 12,
    THUMB_OFFSET_STACKPOINTER_OPCODE = 0b10110000 << 8,
    THUMB_PUSH_POP_REGISTERS_OPCODE = 0b1011 << 12 | 0b10 << 9,
    THUMB_LOAD_STORE_HALFWORD_OPCODE = 0b1000 << 12,
    THUMB_SP_RELATIVE_LOAD_STORE_OPCODE = 0b1001 << 12,
    THUMB_LOAD_ADDRESS_OPCODE = 0b1010 << 12,
    THUMB_LOAD_STORE_WITH_OFFSET_OPCODE = 0b011 << 13,
    THUMB_LOAD_STORE_WITH_REG_OFFSET_OPCODE = 0b0101 << 12 << 0b0 << 9,
    THUMB_LOAD_STORE_SIGN_EXTENDED_BYTE_HALFWORD_OPCODE = 0b0101 << 12 | 0b1 << 9,
    THUMB_PC_RELATIVE_LOAD_OPCODE = 0b01001 << 11,
    THUMB_HI_REG_OPERATION_BRANCH_EXCHANGE_OPCODE = 0b010001 << 10,
    THUMB_ALU_OPERATIONS_OPCODE = 0b010000 << 10,
    THUMB_MOV_CMP_ADD_SUB_IMM_OPCODE = 0b001 << 13,
    THUMB_ADD_SUB_OPCODE = 0b00011 << 11,
    THUMB_MOVE_SHIFTED_REGISTER_OPCODE = 0b000 << 13,
};

enum thumb_instruction_set_opcode_mask
{
    THUMB_SOFTWARE_INTERRUPT_OPCODE_MASK = 0b11111111 << 8,
    THUMB_UNCONDITIONAL_BRANCH_OPCODE_MASK = 0b11111 << 11,
    THUMB_CONDITIONAL_BRANCH_OPCODE_MASK = 0b1111 << 12,
    THUMB_MULTIPLE_LOAD_STORE_OPCODE_MASK = 0b1111 << 12,
    THUMB_LONG_BRANCH_AND_LINK_OPCODE_MASK = 0b1111 << 12,
    THUMB_OFFSET_STACKPOINTER_OPCODE_MASK = 0b11111111 << 8,
    THUMB_PUSH_POP_REGISTERS_OPCODE_MASK = 0b1111 << 12 | 0b11 << 9,
    THUMB_LOAD_STORE_HALFWORD_OPCODE_MASK = 0b1111 << 12,
    THUMB_SP_RELATIVE_LOAD_STORE_OPCODE_MASK = 0b1111 << 12,
    THUMB_LOAD_ADDRESS_OPCODE_MASK = 0b1111 << 12,
    THUMB_LOAD_STORE_WITH_OFFSET_OPCODE_MASK = 0b111 << 13,
    THUMB_LOAD_STORE_WITH_REG_OFFSET_OPCODE_MASK = 0b1111 << 12 | 0b1 << 9,
    THUMB_LOAD_STORE_SIGN_EXTENDED_BYTE_HALFWORD_OPCODE_MASK = 0b1111 << 12 | 0b1 << 9,
    THUMB_PC_RELATIVE_LOAD_OPCODE_MASK = 0b11111 << 11,
    THUMB_HI_REG_OPERATION_BRANCH_EXCHANGE_OPCODE_MASK = 0b111111 << 10,
    THUMB_ALU_OPERATIONS_OPCODE_MASK = 0b111111 << 10,
    THUMB_MOV_CMP_ADD_SUB_IMM_OPCODE_MASK = 0b111 << 13,
    THUMB_ADD_SUB_OPCODE_MASK = 0b111 << 13,
    THUMB_MOVE_SHIFTED_REGISTER_OPCODE_MASK = 0b111 << 13,
};
